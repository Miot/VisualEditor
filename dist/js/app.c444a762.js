(function(){var e={1353:function(e,t,n){"use strict";var o=n(9242),r=n(3396);const l={class:"app"};function s(e,t,n,o,s,a){const u=(0,r.up)("editorHost");return(0,r.wg)(),(0,r.iD)("div",l,[(0,r.Wm)(u,{modelValue:o.state,"onUpdate:modelValue":t[0]||(t[0]=e=>o.state=e)},null,8,["modelValue"])])}var a=n(4870),u=JSON.parse('{"container":{"width":"550","height":"550"},"blocks":[{"top":100,"left":100,"zIndex":1,"type":"text"},{"top":200,"left":100,"zIndex":1,"type":"button"},{"top":300,"left":100,"zIndex":1,"type":"input"}]}'),i=(0,r.aZ)({props:{data:{type:Object}},setup(e){const t=(0,a.qj)(e?.data),n=(0,r.Fl)((()=>({top:`${t.top}px`,left:`${t.left}px`,zIndex:`${t.zIndex}`}))),o=(0,r.f3)("config"),l=(0,a.iH)(null),s=(0,a.iH)(e.data.alignCenter);return(0,r.bv)((()=>{const{offsetWidth:e,offsetHeight:n}=l.value;s.value&&(t.left-=e/2,t.top-=n/2,s.value=!1),t.width=e,t.height=n})),()=>{const t=o.componentMap[e.data.type],s=t?.render();return(0,r.Wm)("div",{class:"editor-block",style:n.value,ref:l},[s])}}}),c=n(5835),d=n.n(c),p=n(2177),f=n.n(p);n(7658);function v(e,t){let n=null;const o=e=>{e.dataTransfer.dropEffect="move"},r=e=>{e.preventDefault()},l=e=>{e.dataTransfer.dropEffect="none"},s=e=>{t.value.blocks.push({top:e.offsetY,left:e.offsetX,zIndex:1,type:n.type,alignCenter:!0})},a=(t,a)=>{n=a;const u=e.value;u.addEventListener("dragenter",o),u.addEventListener("dragover",r),u.addEventListener("dragleave",l),u.addEventListener("drop",s)},u=()=>{const t=e.value;t.removeEventListener("dragenter",o),t.removeEventListener("dragover",r),t.removeEventListener("dragleave",l),t.removeEventListener("drop",s)};return{dragstart:a,dragend:u}}function h(e){let t=(0,a.iH)(-1);const n=(0,r.Fl)((()=>e.value.blocks[t.value])),o=(n,o,r)=>{n.preventDefault(),n.stopPropagation(),t.value=r;const s=e.value.blocks.filter((e=>e.selected)).length;n.shiftKey?o.selected=!o.selected:o.selected||(s>=1&&l(),o.selected=!0),c(n)},l=()=>{e.value.blocks.forEach((e=>e.selected=!1))},s=(0,r.Fl)((()=>({selected:e.value.blocks.filter((e=>e.selected)),unselected:e.value.blocks.filter((e=>!e.selected))})));let u={startX:0,startY:0},i=(0,a.qj)({x:null,y:null});const c=e=>{const{width:t,height:o}=n.value;u={startX:e.clientX,startY:e.clientY,startLeft:n.value.left,startTop:n.value.top,startPos:s.value.selected.map((({top:e,left:t})=>({top:e,left:t}))),lines:(()=>{const{unselected:e}=s.value;let n={x:[],y:[]};return e.forEach((e=>{const{top:r,left:l,width:s,height:a}=e;n.y.push({showTop:r,top:r}),n.y.push({showTop:r,top:r-o}),n.y.push({showTop:r+a/2,top:r+a/2-o/2}),n.y.push({showTop:r+a,top:r+a}),n.y.push({showTop:r+a,top:r+a-o}),n.x.push({showLeft:l,left:l}),n.x.push({showLeft:l+s,left:l+s}),n.x.push({showLeft:l+s/2,left:l+s/2-t/2}),n.x.push({showLeft:l+s,left:l+s-t}),n.x.push({showLeft:l,left:l-t})})),n})()},document.addEventListener("mousemove",d),document.addEventListener("mouseup",p)},d=e=>{let{clientX:t,clientY:n}=e;const o=t-u.startX+u.startLeft,r=n-u.startY+u.startTop;let l=null,a=null;const c=u.lines;for(let s=0;s<c.y.length;s++){const{showTop:e,top:t}=c.y[s];if(Math.abs(t-r)<5){l=e,n=u.startY-u.startTop+t;break}}for(let s=0;s<c.x.length;s++){const{showLeft:e,left:n}=c.x[s];if(Math.abs(n-o)<5){a=e,t=u.startX-u.startLeft+n;break}}i.x=a,i.y=l;const d=t-u.startX,p=n-u.startY;s.value.selected.forEach(((e,t)=>{e.top=u.startPos[t].top+p,e.left=u.startPos[t].left+d}))},p=e=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",p),i.x=null,i.y=null};return{blcokMousedown:o,clearMousedown:l,markLine:i}}var m=(0,r.aZ)({props:{modelValue:{type:Object}},emits:["update:modelValue"],components:{editorBlock:i,prewviewItem:d()},setup(e,t){const n=(0,r.f3)("config"),o=(0,r.Fl)({get(){return e.modelValue},set(e){t.emit("update:modelValue",f()(e))}}),l=(0,r.Fl)((()=>({width:o.value.container.width+"px",height:o.value.container.height+"px"}))),s=(0,a.iH)(null),{dragstart:u,dragend:c}=v(s,o),{blcokMousedown:d,clearMousedown:p,markLine:m}=h(o);return()=>(0,r.Wm)("div",{class:"editor"},[(0,r.Wm)("div",{class:"editor-left"},[n.componentList.map((e=>(0,r.Wm)("div",{class:"preview-item",draggable:!0,ondragstart:t=>u(t,e),ondragend:t=>c(t,e)},[(0,r.Wm)("span",{class:"name"},[e.label]),(0,r.Wm)("div",{class:"component"},[e.preview()])])))]),(0,r.Wm)("div",{class:"editor-top"},[(0,r.Uk)("菜单")]),(0,r.Wm)("div",{class:"editor-right"},[(0,r.Uk)("右侧")]),(0,r.Wm)("div",{class:"editor-container"},[(0,r.Wm)("div",{class:"editor-canvas"},[(0,r.Wm)("div",{class:"editor-canvas-content",style:l.value,ref:s,onmousedown:p},[o.value.blocks.map(((e,t)=>(0,r.Wm)(i,{class:e.selected?"editor-block-selected":"",data:e,onmousedown:n=>d(n,e,t)},null))),null!==m.x&&(0,r.Wm)("div",{class:"line-x",style:{left:m.x+"px"}},null),null!==m.y&&(0,r.Wm)("div",{class:"line-y",style:{top:m.y+"px"}},null)])])])])}});function g(){const e=[],t={};return{componentList:e,componentMap:t,register:n=>{e.push(n),t[n.type]=n}}}const b=g();b.register({label:"文本",preview:()=>"预览文本",render:()=>"渲染文本",type:"text"}),b.register({label:"按钮",preview:()=>(0,r.Wm)("button",null,[(0,r.Uk)("预览按钮")]),render:()=>(0,r.Wm)("button",null,[(0,r.Uk)("渲染按钮")]),type:"button"}),b.register({label:"输入框",preview:()=>(0,r.Wm)("input",{placeholder:"预览输入框"},null),render:()=>(0,r.Wm)("input",{placeholder:"渲染输入框"},null),type:"input"});var w={components:{editorHost:m},setup(){const e=(0,a.iH)(u);return(0,r.JJ)("config",b),{state:e}}},y=n(89);const x=(0,y.Z)(w,[["render",s]]);var k=x;(0,o.ri)(k).mount("#app")},5835:function(){}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,l){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],l=e[c][2];for(var a=!0,u=0;u<o.length;u++)(!1&l||s>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[u])}))?o.splice(u--,1):(a=!1,l<s&&(s=l));if(a){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,r,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,l,s=o[0],a=o[1],u=o[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(u)var c=u(n)}for(t&&t(o);i<s.length;i++)l=s[i],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(c)},o=self["webpackChunkvisual_editor"]=self["webpackChunkvisual_editor"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(1353)}));o=n.O(o)})();